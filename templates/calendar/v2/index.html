{% extends "base.html" %}
{% from '/macros/spinner.html' import spinner%}
{% block title %}Ennytime Couple's Calendar{% endblock title %}
{% block content %}
    <section class="py-4">
        <div class="max-w-[1000px] mx-auto px-2">
            <div id="calendar-heading" class="mb-4">
                <h1 class="text-5xl text-center mb-4">{{current_month.strftime("%B, %Y")}}</h1>
                {% include "/calendar/fragments/controls-buttons.html" %}
            </div>
            <div data-js-calendar class="js-calendar grid grid-cols-7 border border-collapse border-gray-300 md:border-0 md:gap-2">
                {# calendar day headings #}
                {% for day_name in days_of_week %}
                    <div class="text-center text-xl font-bold">{{ day_name }}</div>
                {% endfor %}
                {# calendar cards #}
                {% for value in month_calendar.values() %}
                    {% if value.month != current_month.month %}
                    <div class="text-center min-h-[72px] md:border border-gray-400 md:rounded bg-gray-200">
                        <h2>{{value.day}}</h2>
                    </div>
                    {% else %}
                        {% set date_key = value.strftime("%Y-%m-%d") %}
                        <div class="grid grid-rows-3 gap-2 text-center min-h-[72px] border md:border-gray-900 md:rounded bg-white md:p-2">
                            <h2 class="row-start-1">{{value.day}}</h2>
                            {# current user schedule #}
                            {% if commitments.get(value.strftime(date_key)) %}
                                {% set commitment = commitments.get(value.strftime(date_key)) %}
                                {% if commitment|length >= 2  %}
                                    <div class="row-start-2 bg-pink-500 rounded-md">x{{commitment|length}}</div>
                                {% else %}
                                    {% set shift_id = commitment.keys()|list|first %}
                                    <div class="row-start-2 bg-pink-500 rounded-md">{{shifts.get(shift_id).short_name}}</div>
                                {% endif %}
                            {% endif %}
                            {# bae user schedule #}
                            {% if bae_commitments.get(value.strftime(date_key)) %}
                                {% set commitment = bae_commitments.get(value.strftime(date_key)) %}
                                {% if commitment|length >= 2  %}
                                    <div class="row-start-3 bg-pink-300 rounded-md">x{{commitment|length}}</div>
                                {% else %}
                                    {% set shift_id = commitment.keys()|list|first %}
                                    <div class="row-start-3 bg-pink-300 rounded-md">{{bae_shifts.get(shift_id).short_name}}</div>
                                {% endif %}
                            {% endif %}
                        </div>
                    {% endif %}
                {% endfor %}
            </div>

        </div>
    </section>
{% endblock content %}